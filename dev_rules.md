# üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Poetry)

–ú—ã –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –µ–¥–∏–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —á–µ—Ä–µ–∑ **Poetry**.
–≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞–ª—Å—è –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Linux/GPU), –∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö (Windows/CPU), –∏ —É –∑–∞–∫–∞–∑—á–∏–∫–∞.

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —É–∂–µ –ª–µ–∂–∞—Ç —Ñ–∞–π–ª—ã `pyproject.toml` (—Å–ø–∏—Å–æ–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫) –∏ `poetry.lock` (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏).

---

## 1. –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (One-time setup)

–°–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–π—Ç–µ `git pull`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏. –î–∞–ª–µ–µ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ–¥ —Å–≤–æ—é –û–°.

### –í–∞—Ä–∏–∞–Ω—Ç –ê: Windows (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Conda)
–¢–∞–∫ –∫–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –≥–µ–æ-–¥–∞–Ω–Ω—ã–º–∏ (`gdal`, `rasterio`), –Ω–∞ Windows —Å–ª–æ–∂–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã –≤—Ä—É—á–Ω—É—é. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: **Conda —Å—Ç–∞–≤–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–±—ã, Poetry ‚Äî python –ø–∞–∫–µ—Ç—ã.**

1.  **–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª** (Anaconda Prompt –∏–ª–∏ VS Code —Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π Conda).
2.  **–°–æ–∑–¥–∞–π—Ç–µ/–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ** (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —á–∏—Å—Ç–æ–µ, –µ—Å–ª–∏ —Å—Ç–∞—Ä–æ–µ –≥–ª—é—á–∏—Ç):
    ```bash
    # –°–æ–∑–¥–∞–µ–º —Å –±–∞–∑–æ–≤—ã–º–∏ —Ç—è–∂–µ–ª—ã–º–∏ –ª–∏–±–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∏—Ö
    conda create -n geo_sam python=3.10 gdal rasterio -c conda-forge -y
    conda activate geo_sam
    ```
3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Poetry** (–≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è):
    ```bash
    pip install poetry
    ```
4.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Poetry** (–í–∞–∂–Ω–æ!):
    –ú—ã –≥–æ–≤–æ—Ä–∏–º Poetry –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é –ø–∞–ø–∫—É, –∞ —Å—Ç–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø—Ä—è–º–æ –≤ —Ç–µ–∫—É—â—É—é Conda-env.
    ```bash
    poetry config virtualenvs.create false --local
    ```
5.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞:**
    ```bash
    # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å—ë + –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ç–µ—Ç—Ä–∞–¥–æ–∫ (Jupyter –∏ —Ç.–¥.)
    poetry install --with research
    ```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: Linux / macOS (–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥)
–ó–¥–µ—Å—å –≤—Å—ë –ø—Ä–æ—â–µ, GDAL –æ–±—ã—á–Ω–æ —Å—Ç–∞–≤–∏—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏–ª–∏ —É–∂–µ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ.

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Poetry** (–≥–ª–æ–±–∞–ª—å–Ω–æ):
    ```bash
    curl -sSL https://install.python-poetry.org | python3 -
    ```
2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:**
    ```bash
    # –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É .venv –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞ (—É–¥–æ–±–Ω–æ –¥–ª—è VS Code/PyCharm)
    poetry config virtualenvs.in-project true --local
    ```
3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    poetry install --with research
    ```
4.  **–ê–∫—Ç–∏–≤–∞—Ü–∏—è:**
    ```bash
    poetry shell
    # –ò–ª–∏ source .venv/bin/activate
    ```

---

## 2. –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—Ç—å?

### –ó–∞–ø—É—Å–∫ –∫–æ–¥–∞
–í–º–µ—Å—Ç–æ `python script.py` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
poetry run python script.py


–í–æ—Ç –≥–æ—Ç–æ–≤–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–≥–æ `SETUP_GUIDE.md` (–Ω–∞—á–∏–Ω–∞—è —Å –ø—Ä–∞–≤–∏–ª —Ä–∞–±–æ—Ç—ã –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –ª–æ–≥–∏–∫–æ–π CPU/GPU). –Ø —É–±—Ä–∞–ª –≤—Å–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ñ–æ—Ä–º–∏–ª –∫–æ–¥.

–ü—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫ –≤ –∫–æ–Ω–µ—Ü –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞:

```markdown
### –ó–∞–ø—É—Å–∫ –∫–æ–¥–∞

–ï—Å–ª–∏ –≤—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏ –æ–±–æ–ª–æ—á–∫—É (`conda activate` –∏–ª–∏ `poetry shell`), –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ `python script.py`. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
poetry run python script.py
```

### –ó–∞–ø—É—Å–∫ Jupyter Lab
```bash
poetry run jupyter lab
```

---

### ‚õî –ó–ê–ü–†–ï–©–ï–ù–û
*   ‚ùå `pip install <lib>` ‚Äî —ç—Ç–æ —Å–ª–æ–º–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –∫–æ–º–∞–Ω–¥–æ–π.
*   ‚ùå –£–¥–∞–ª—è—Ç—å `poetry.lock`.

### ‚úÖ –ö–ê–ö –î–û–ë–ê–í–õ–Ø–¢–¨ –ë–ò–ë–õ–ò–û–¢–ï–ö–ò
–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ –Ω–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `scikit-learn`):

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ—ë:**
   ```bash
   poetry add scikit-learn
   ```
   *–≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç `pyproject.toml` –∏ `poetry.lock`.*

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç.**

3. **–ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –û–ë–ê —Ñ–∞–π–ª–∞:**
   ```bash
   git add pyproject.toml poetry.lock
   git commit -m "Add scikit-learn"
   ```

---

## 3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥ CPU –∏ GPU (–í–∞–∂–Ω–æ!)

–ù–∞—à —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≥–¥–µ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å NVIDIA GPU), –Ω–æ –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CUDA, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å.

**–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö–∞—Ä–¥–∫–æ–¥ `.to('cuda')`!**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–Ω–∏–ø–ø–µ—Ç –≤ –Ω–∞—á–∞–ª–µ –≤–∞—à–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤/–º–æ–¥–µ–ª–µ–π:

```python
import torch

def get_device():
    if torch.cuda.is_available():
        return torch.device("cuda")
    elif torch.backends.mps.is_available(): # –î–ª—è Apple Silicon (M1/M2)
        return torch.device("mps")
    else:
        return torch.device("cpu")

DEVICE = get_device()
print(f"üöÄ Running on: {DEVICE}")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
# model = SamModel.from_pretrained("facebook/sam-vit-huge").to(DEVICE)
```
```